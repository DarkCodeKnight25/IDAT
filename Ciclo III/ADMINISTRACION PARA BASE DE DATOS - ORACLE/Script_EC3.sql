
-- CREACION DE TABLAS
Create Table ALUMNO(
     Cod_Alu      VARCHAR2(5) Not Null,
     Nombre       VARCHAR2(50) Not Null,
     Sexo         VARCHAR2(20) Not Null,
     Grado        Int Not Null,
     F_Nacimiento Date Not Null,
     Edad         Int Not Null,
     Estado       Varchar2(20) Not Null,
     CONSTRAINT PK_CODIGO_ALUMNO PRIMARY KEY (Cod_Alu),
     CONSTRAINT CHK_NOMBRE_ALUMNO CHECK (Nombre = NLS_UPPER(Nombre)),
     CONSTRAINT CHK_SEXO_ALUMNO CHECK (SEXO IN ('Masculino','Femenino')),
     CONSTRAINT CHK_GRADO_ALUMNO CHECK (GRADO IN (1,2,3,4,5,6)),
     CONSTRAINT CHK_EDAD_ALUMNO CHECK (EDAD>=10 AND EDAD<=22),
     CONSTRAINT CHK_ESTADO_ALUMNO CHECK (Estado IN ('ACTIVO','BLOQUEADO','SUSPENDIDO','RETIRADO'))
 );
 
 Create Table CURSOS(
     Cod_Curso    VARCHAR2(5) Not Null,
     Descripcion  VARCHAR2(30) Not Null,
     Credito      Integer Not Null,
     Estado       VARCHAR2(20) Not Null,
     CONSTRAINT PK_CODIGO_CURSO PRIMARY KEY (Cod_Curso),
     CONSTRAINT CHK_DESCRIPCION_CURSO CHECK (Descripcion = NLS_UPPER(Descripcion)),
     CONSTRAINT CHK_CREDITO_CURSO CHECK (Credito IN (2, 3, 4, 6)),
     CONSTRAINT CHK_ESTADO_CURSO CHECK (Estado IN ('ACTIVO','BLOQUEADO'))
 );

Create Table PROFESOR(
     Cod_Prof     VARCHAR2(5) Not Null,
     Nombre       VARCHAR2(50) Not Null,
     Profesion    Varchar2(50) Not Null,
     F_Nac        Date Not Null,
     Dni          Char(8) Not Null,
     Sexo         VARCHAR2(20) Not Null,
     Edad         Int Not Null,
     Estado       Varchar2(20) Not Null,
     CONSTRAINT PK_CODIGO_PROFESOR PRIMARY KEY (Cod_Prof),
     CONSTRAINT CHK_NOMBRE_PROFESOR CHECK (Nombre = NLS_UPPER(Nombre)),
     CONSTRAINT CHK_PROFESION_PROFESOR CHECK (Profesion = NLS_UPPER(Profesion)),
     CONSTRAINT CHK_SEXO_PROFESOR CHECK (SEXO IN ('Masculino','Femenino')),
     CONSTRAINT CHK_EDAD_PROFESOR CHECK (EDAD>=25 AND EDAD<=60),
     CONSTRAINT CHK_ESTADO_PROFESOR CHECK (Estado IN ('ACTIVO','BLOQUEADO','SUSPENDIDO','RETIRADO'))
 );
 
 Create Table NOTAS (
     Cod_Alu      VARCHAR2(5) Not Null,
     Cod_Curso    VARCHAR2(5) Not Null,
     Cod_Prof     VARCHAR2(5) Not Null,
     Nota1        Int Not Null,
     Nota2        Int Not Null,
     Nota3        Int Not Null,
     Nota4        Int Not Null,
     Fecha        Date Not Null,
     CONSTRAINT PK_ALUMNO_CURSO_PROFESOR PRIMARY KEY (Cod_Alu,Cod_Curso,Cod_Prof),
     CONSTRAINT CHK_NOTA1 CHECK (NOTA1>=0 AND NOTA1<=20),
     CONSTRAINT CHK_NOTA2 CHECK (NOTA2>=0 AND NOTA2<=20),
     CONSTRAINT CHK_NOTA3 CHECK (NOTA3>=0 AND NOTA3<=20),
     CONSTRAINT CHK_NOTA4 CHECK (NOTA4>=0 AND NOTA4<=20),
     CONSTRAINT FK_REL_NOTAS_ALUMNO FOREIGN KEY (COD_ALU) REFERENCES ALUMNO(COD_ALU),
     CONSTRAINT FK_REL_NOTAS_CURSO FOREIGN KEY (COD_CURSO) REFERENCES CURSOS(COD_CURSO),
     CONSTRAINT FK_REL_NOTAS_PROFESOR FOREIGN KEY (COD_PROF) REFERENCES PROFESOR(COD_PROF)
 );

CREATE TABLE STAFF(
	ID Numeric (5, 0) PRIMARY KEY NOT NULL ,
	NAME Varchar2 (10) NOT NULL ,
	DEPT Numeric (5, 0) NOT NULL ,
	JOB Varchar2 (6) NOT NULL ,
	YEARS Numeric (5, 0) NULL ,
	SALARY Numeric (8, 2) NOT NULL ,
	COMM Numeric (8, 2) NULL 
);

CREATE TABLE LIBRO(
            CODLIB VARCHAR2(5) PRIMARY KEY NOT NULL,        
            TITULOLIB   VARCHAR2(32),        
            AUTORLIB    VARCHAR2(24),        
            EDITOLIB    VARCHAR2(13),        
            AREALIB     VARCHAR2(9),        
            PRECIOLIB   NUMERIC(8,2),    
            NHOJASLIB   INT,            
            ANOLIB      INT);

CREATE TABLE TRABAJADOR ( 
    COD_TRA VARCHAR2 (5) NOT NULL,
    AP_TRA VARCHAR2 (15) NULL,
    AM_TRA VARCHAR2 (15) NULL,
    NOM_TRA VARCHAR2 (15) NULL,
    FECHA_NA DATE NULL,
    SUELDO NUMERIC (8,2) NULL,
    GENERO_TRA VARCHAR2 (1) NULL,
    AREA_TRA VARCHAR2 (30) NULL,
    PRIMARY KEY (COD_TRA));

-- INSERCION DE DATOS.
INSERT INTO LIBRO VALUES('1000','VISUAL FOX','RUBEN IGLESIAS','RAMA','LPROG',60,489,1997);
INSERT INTO LIBRO VALUES('1001','POWER BUILDER 6.','RAMIRO HOOL','UNI','LPROG',80,410,1999);
INSERT INTO LIBRO VALUES('1002','ANALISIS Y DISEÑO DE SIST.','KENDALL Y KENDALL','PRINTICE HALL','ANALISIS',100,913,1997);
INSERT INTO LIBRO VALUES('1003','POWER BUILDER 6.','WILLIAM B. HEYS','QUE','LPROG',150,843,1999);
INSERT INTO LIBRO VALUES('1004','VISUAL BASIC','CESAR BUSTAMANTE','GRAPPERU','LPROG',35,390,1997);
INSERT INTO LIBRO VALUES('1005','VISUAL FOX PRO','LES Y JHON PINTER','MC GRAWHILL','LPROG',25,567,1997);
INSERT INTO LIBRO VALUES('1006','GUIA C++','JULIO VASQUEZ PARAGULLAS','UPSMP','LPROG',50,780,1997);
INSERT INTO LIBRO VALUES('1007','MS C++','BECK ZARATIAN','MICROSOFT','LPROG',80,600,1999);
INSERT INTO LIBRO VALUES('1008','VISUAL FOX PRO 6.00','CESAR BUSTAMANTE','UNI','LPROG',35,450,1999);
INSERT INTO LIBRO VALUES('1009','AUTOCAD 2000','J.A. TAJADURA J. LOPEZ','MC GRAW HILL','CAD',40,480,1998);
INSERT INTO LIBRO VALUES('1010','EFECTOS COREL','ANOMINO','MACRO','ARTE',50,400,1998);
INSERT INTO LIBRO VALUES('1011','EL VENDEDOR MAS GRANDE DEL MUNDO','OG MANDINO','DIANA','LIDERAZGO',15,121,1968);
INSERT INTO LIBRO VALUES('1012','EL PODER DEL CARISMA','MIGUEL ANGEL CORNEJO','ESTRELLA','LIDERAZGO',15,123,1992);
INSERT INTO LIBRO VALUES('1013','7 HABITOS DE LA GENTE EFECTIVA','STEPHEN  R. COVER','PAIDOS','LIDERAZGO',50,460,1989);
INSERT INTO LIBRO VALUES('1014','CRITERIOS EVA. PROY.','NASSIR SAPAG CHAIN','MC GRAW HILL','PROYECTOS',10,144,1997);
INSERT INTO LIBRO VALUES('1015','COMO DIRIGIR MICRO EMP.','VICTOR ABAD G.','IPEDE','PROYECTOS',10,110,1995);
INSERT INTO LIBRO VALUES('1016','LA MAGIA DE PENSAR EN GRANDE','DAVID JASEPH SCHWRTZ','HERREROS MEX','LIDERAZGO',10,258,1960);
INSERT INTO LIBRO VALUES('1017','SQL SERVER VB','WILLIAM R. VAUGHN','MICROSOFT','LPROG',60,1000,1999);
INSERT INTO LIBRO VALUES('1018','VISUAL FOX 6.00','MENACHEN BAZIAN','QUE','LPROG',55,1000,1999);
INSERT INTO LIBRO VALUES('1019','INTELIGENCIA EMOCIONAL','DANIEL GOLEMAN','ZETA','LIDERAZGO',48,396,1996);
INSERT INTO LIBRO VALUES('1020','LA TERCERA OLA','ALVIN TOFFLER','MC GRAW HILL','LIDERAZGO',50,250,1998);
COMMIT;

INSERT INTO TRABAJADOR VALUES ('00001','DE LA MADRID','GUTIERREZ' , 'MARICIELO', '01/11/1980',980,'F','CONTABILIDAD');
INSERT INTO TRABAJADOR VALUES ('00002','HURTADO','CORONEL', 'NILDA', '10/10/1976',980.50,'F','CONTABILIDAD');
INSERT INTO TRABAJADOR VALUES ('00003','PAREDES','MARTINEZ','EDITH', '10/10/1976',1500.50,'F','SISTEMAS');
INSERT INTO TRABAJADOR VALUES ('00004','CARDOSO','VALLADARES','HENRY', '10/10/1980',1200.5,'M','SISTEMAS');
INSERT INTO TRABAJADOR VALUES('00005','UBILLUS','MARQUEZ','MIGUEL ANGEL', '05/01/1976',980.60,'M','CONTABILIDAD');
INSERT INTO TRABAJADOR VALUES('00006','LIZARRAGA','DEL OLMO','NUPCIA MASSIEL','05/10/1980',1300.70,'F','SISTEMAS');
INSERT INTO TRABAJADOR VALUES('00007','AGUIRRE','RIVADENEIRA','VANNIA', '05/10/1975',1200.10,'F','SISTEMAS');
INSERT INTO TRABAJADOR VALUES('00008','JUAREZ','LAZO','GINO','05/10/1969',1200.30,'M','LOGISTICA');
INSERT INTO TRABAJADOR VALUES('00009','PINTADO','ROBLES','JUAN ABEL', '28/08/1984',1000.50,'M','LOGISTICA');
INSERT INTO TRABAJADOR VALUES('00010','BARRANTES','MEDINA','LUIS ALBERTO','28/08/1975',1000.90,'M','LOGISTICA');
INSERT INTO TRABAJADOR VALUES ('00011','CAMPOS','GAMBO' , 'SONIA', '02/11/1980',NULL,'F','CONTABILIDAD');
INSERT INTO TRABAJADOR VALUES ('00012','HURTADO','SANCHEZ', 'SUSANA', '12/11/1976',980.50,'F','CONTABILIDAD');
INSERT INTO TRABAJADOR VALUES ('00013','CANTUR','GOMEZ','ELIZABETH', '12/10/1976',NULL,'F','SISTEMAS');
INSERT INTO TRABAJADOR VALUES ('00014','SALAS','CARPIO','ROBERT', '16/12/1982',1200.5,'M','SISTEMAS');
INSERT INTO TRABAJADOR VALUES('00015','UBILLUS','CAMPOS','MIGUEL', '15/04/1976',NULL,'M','CONTABILIDAD');
INSERT INTO TRABAJADOR VALUES('00016','SANCHEZ','DE LA CRUZ','LORENA','05/10/1980',1800.70,'F','SISTEMAS');
INSERT INTO TRABAJADOR VALUES('00017','GUTIERREZ','NAVARRO','CECILIA', '15/11/1979',NULL,'F','SISTEMAS');
INSERT INTO TRABAJADOR VALUES('00018','JUAREZ','SANTOS','MAGNO','15/12/1969',1600.50,'M','LOGISTICA');
INSERT INTO TRABAJADOR VALUES('00019','OROPEZA','ESTRADA','CARLOSL', '28/09/1985',NULL,'M','LOGISTICA');
INSERT INTO TRABAJADOR VALUES('00020','ESTRADA','CAMPOS','JUAN JOSE','18/05/1979',NULL,'M','LOGISTICA');
COMMIT;

INSERT INTO STAFF VALUES (10,'SANDERS',20,'MGR',7,18357.50,NULL);
INSERT INTO STAFF VALUES (20,'PERNAL',20,'SALES',8,18171.25,612.45);
INSERT INTO STAFF VALUES (30,'MARENGHI',38,'MGR',5,17506.75,NULL);
INSERT INTO STAFF VALUES (40,'O BRIEN',38,'SALES',6,18006.00,846.55);
INSERT INTO STAFF VALUES (50,'HANES',15,'MGR',10,20659.80,NULL);
INSERT INTO STAFF VALUES (60,'QUIGLEY',38,'SALES',NULL,16808.30,650.25);
INSERT INTO STAFF VALUES (70,'ROTHMAN',15,'SALES',7,16502.83,1152.00);
INSERT INTO STAFF VALUES (80,'JAMES',20,'CLERK',NULL,13504.60,128.20);
INSERT INTO STAFF VALUES (90,'KOONITZ',42,'SALES',6,18001.75,1386.70);
INSERT INTO STAFF VALUES (100,'PLOTZ',42,'MGR',7,18352.80,NULL);
INSERT INTO STAFF VALUES (110,'NGAN',15,'CLERK',5,12508.20,206.60);
INSERT INTO STAFF VALUES (120,'NAUGHTON',38,'CLERK',NULL,12954.75,180.00);
INSERT INTO STAFF VALUES (130,'YAMAGUCHI',42,'CLERK',6,10505.90,75.60);
INSERT INTO STAFF VALUES (140,'FRAYE',51,'MGR',6,21150.00,NULL);
INSERT INTO STAFF VALUES (150,'WILLIAMS',51,'SALES',6,19456.50,637.50);
INSERT INTO STAFF VALUES (160,'MCLINARE',10,'MGR',7,22959.20,NULL);
INSERT INTO STAFF VALUES (170,'KERMISCH',15,'CLERK',4,12258.50,110.10);
INSERT INTO STAFF VALUES (180,'ABRAHAMS',38,'CLERK',3,12009.75,236.50);
INSERT INTO STAFF VALUES (190,'SNEIDER',20,'CLERK',8,14252.75,126.50);
INSERT INTO STAFF VALUES (200,'SCOUTTEN',42,'CLERK',NULL,11508.60,84.20);
INSERT INTO STAFF VALUES (210,'LU',10,'MGR',10,20010.00,NULL);
INSERT INTO STAFF VALUES (220,'SMITH',51,'SALES',7,17564.50,992.80);
INSERT INTO STAFF VALUES (230,'LUNDQUIST',51,'CLERK',3,13369.80,189.65);
INSERT INTO STAFF VALUES (240,'DANIELS',10,'MGR',5,19260.25,NULL);
INSERT INTO STAFF VALUES (250,'WHEELER',51,'CLERK',6,14460.00,513.30);
INSERT INTO STAFF VALUES (260,'JONES',10,'MGR',12,21234.00,NULL);
INSERT INTO STAFF VALUES (270,'LEA',66,'MGR',9,18555.50,NULL);
INSERT INTO STAFF VALUES (280,'WILSON',66,'SALES',9,18674.50,811.50);
INSERT INTO STAFF VALUES (290,'QUILL',84,'MGR',10,19818.00,NULL);
INSERT INTO STAFF VALUES (300,'DAVIS',84,'SALES',5,15454.50,806.10);
INSERT INTO STAFF VALUES (310,'GRAHAM',66,'SALES',13,21000.00,200.30);
INSERT INTO STAFF VALUES (320,'GONZALES',66,'SALES',4,16858.20,844.00);
INSERT INTO STAFF VALUES (330,'BURKE',66,'CLERK',1,10988.00,55.50);
INSERT INTO STAFF VALUES (340,'EDWARDS',84,'SALES',7,17844.00,1285.00);
INSERT INTO STAFF VALUES (350,'GAFNEY',84,'CLERK',5,13030.00,188.00);
COMMIT;

Insert Into ALUMNO Values ('A0001', 'PEREZ SANCHEZ JUAN','Masculino', 1,'22/07/2000', 19, 'ACTIVO');
Insert Into ALUMNO Values ('A0002', 'SARMIENTO CESPEDES CARMEN','Femenino', 1,'20/08/2005', 15, 'ACTIVO');
Insert Into ALUMNO Values ('A0003', 'ALCANTARA VARGAS CARLOS','Masculino', 2,'05/06/2004', 16, 'ACTIVO');
Insert Into ALUMNO Values ('A0004', 'SANCHEZ CAMPOS LUIS','Masculino', 1,'10/04/2000', 19, 'ACTIVO');
Insert Into ALUMNO Values ('A0005', 'VALDIVIA SALCEDO ELIZABETH','Femenino', 1,'05/04/2005', 15, 'ACTIVO');
Insert Into ALUMNO Values ('A0006', 'ESPINOZA VARGAS CELINA','Femenino', 2,'22/03/2004', 16, 'ACTIVO');
Insert Into ALUMNO Values ('A0007', 'CAMPOS FLORES EDUARDO','Masculino', 3,'02/06/1999', 20, 'ACTIVO');
Insert Into ALUMNO Values ('A0008', 'NAVARRO RODRIGUEZ CELESTE','Femenino', 3,'10/02/2000', 19, 'ACTIVO');
Insert Into ALUMNO Values ('A0009', 'RAMIREZ OCHOA ALEJANDRA','Femenino', 2,'01/03/2002', 17, 'ACTIVO');
Insert Into ALUMNO Values ('A0010', 'SALAS FERNANDEZ JULIAN','Masculino', 2,'05/03/2002', 17, 'ACTIVO');
COMMIT;

Insert Into CURSOS Values ('C0001', 'MATEMATICA',4,'ACTIVO');
Insert Into CURSOS Values ('C0002', 'LENGUAJE',6,'ACTIVO');
Insert Into CURSOS Values ('C0003', 'QUIMICA',4,'ACTIVO');
Insert Into CURSOS Values ('C0004', 'HISTORIA',3,'ACTIVO');
Insert Into CURSOS Values ('C0005', 'GEOGRAFIA',3,'ACTIVO');
COMMIT;

Insert Into PROFESOR Values ('P0001', 'ALVAREZ SANCHEZ JULIA','ING DE SISTEMAS','13/02/1980','02145874','Femenino',39,'ACTIVO');
Insert Into PROFESOR Values ('P0002', 'SALAS ORMEÑO ELIZABETH','CONTADORA PUBLICA','16/04/1900','05878545','Femenino',29,'ACTIVO');
Insert Into PROFESOR Values ('P0003', 'SANCHEZ VERASTEGUI JULIAN','DR. EN MEDICINA GEN..','10/05/1970','03685985','Masculino',49,'ACTIVO');
Insert Into PROFESOR Values ('P0004', 'LOPEZ ALCANTARA CLARA','DR. GINECOLOGIA','05/07/1985','02547845','Femenino',34,'ACTIVO');
Insert Into PROFESOR Values ('P0005', 'SANDOVAL PEREZ MELISSA','SECRETARIA EJECUTIVA','25/04/1990','05478458','Femenino',29,'ACTIVO');
COMMIT;

Insert Into NOTAS Values ('A0001', 'C0001', 'P0001', 14, 16, 17, 18,'07/01/2019');
Insert Into NOTAS Values ('A0001', 'C0002', 'P0001', 13, 15, 14, 17,'07/01/2019');
Insert Into NOTAS Values ('A0001', 'C0003', 'P0002', 10, 10, 10, 10,'07/01/2019');
Insert Into NOTAS Values ('A0001', 'C0004', 'P0003', 17, 18, 16, 17,'07/01/2019');
Insert Into NOTAS Values ('A0001', 'C0005', 'P0004', 7, 7, 8, 8,'07/01/2019');

Insert Into NOTAS Values ('A0002', 'C0001', 'P0004', 15, 12, 11, 10,'07/01/2019');
Insert Into NOTAS Values ('A0002', 'C0002', 'P0003', 12, 10, 10, 11,'07/01/2019');
Insert Into NOTAS Values ('A0002', 'C0003', 'P0005', 14, 14, 14, 17,'07/01/2019');
Insert Into NOTAS Values ('A0002', 'C0004', 'P0004', 17, 11, 13, 11,'07/01/2019');
Insert Into NOTAS Values ('A0002', 'C0005', 'P0003', 12, 12, 9, 9,'07/01/2019');

Insert Into NOTAS Values ('A0003', 'C0001', 'P0004', 14, 12, 15, 10,'07/01/2019');
Insert Into NOTAS Values ('A0003', 'C0002', 'P0003', 15, 10, 9, 9,'07/01/2019');
Insert Into NOTAS Values ('A0003', 'C0003', 'P0005', 11, 15, 15, 11,'07/01/2019');
Insert Into NOTAS Values ('A0003', 'C0004', 'P0004', 10, 10, 10, 10,'07/01/2019');
Insert Into NOTAS Values ('A0003', 'C0005', 'P0003', 12, 10, 9, 9,'07/01/2019');

Insert Into NOTAS Values ('A0004', 'C0001', 'P0002', 11, 11, 11, 10,'07/01/2019');
Insert Into NOTAS Values ('A0004', 'C0002', 'P0002', 15, 10, 19, 19,'07/01/2019');
Insert Into NOTAS Values ('A0004', 'C0003', 'P0004', 12, 12, 15, 12,'07/01/2019');
Insert Into NOTAS Values ('A0004', 'C0004', 'P0005', 14, 14, 13, 13,'07/01/2019');
Insert Into NOTAS Values ('A0004', 'C0005', 'P0005', 12, 10, 9, 12,'07/01/2019');

Insert Into NOTAS Values ('A0005', 'C0001', 'P0005', 12, 11, 18, 20,'07/01/2019');
Insert Into NOTAS Values ('A0005', 'C0002', 'P0002', 20, 20, 19, 19,'07/01/2019');
Insert Into NOTAS Values ('A0005', 'C0003', 'P0003', 13, 8, 8, 8,'07/01/2019');
Insert Into NOTAS Values ('A0005', 'C0004', 'P0003', 8, 7, 7, 7,'07/01/2019');
Insert Into NOTAS Values ('A0005', 'C0005', 'P0004', 15, 16, 19, 19,'07/01/2019');

Insert Into NOTAS Values ('A0006', 'C0001', 'P0005', 16, 16, 18, 20,'07/01/2019');
Insert Into NOTAS Values ('A0006', 'C0002', 'P0004', 9, 9, 10, 10,'07/01/2019');
Insert Into NOTAS Values ('A0006', 'C0003', 'P0003', 13, 8, 8, 8,'07/01/2019');

Insert Into NOTAS Values ('A0007', 'C0003', 'P0003', 11, 11, 10, 14,'07/01/2019');
Insert Into NOTAS Values ('A0007', 'C0004', 'P0005', 11, 17, 17, 17,'07/01/2019');
Insert Into NOTAS Values ('A0007', 'C0005', 'P0004', 12, 13, 14, 14,'07/01/2019');

Insert Into NOTAS Values ('A0008', 'C0002', 'P0001', 12, 12, 19, 19,'07/01/2019');
Insert Into NOTAS Values ('A0008', 'C0003', 'P0004', 11, 18, 18, 12,'07/01/2019');
Insert Into NOTAS Values ('A0008', 'C0004', 'P0005', 8, 7, 7, 7,'07/01/2019');

Insert Into NOTAS Values ('A0009', 'C0001', 'P0005', 11, 11, 18, 20,'07/01/2019');
Insert Into NOTAS Values ('A0009', 'C0002', 'P0002', 12, 10, 15, 15,'07/01/2019');

Insert Into NOTAS Values ('A0010', 'C0002', 'P0002', 12, 12, 19, 19,'07/01/2019');
Insert Into NOTAS Values ('A0010', 'C0003', 'P0003', 13, 18, 18, 18,'07/01/2019');
COMMIT;


--CONSULTAS
SELECT * FROM ALUMNO;
SELECT * FROM CURSOS;
SELECT * FROM PROFESOR;
SELECT * FROM NOTAS;
SELECT * FROM STAFF;
SELECT * FROM LIBRO;
SELECT * FROM TRABAJADOR;


-- DESARROLLO DE LOS CASOS
---------------------------------------------------------------------
---PREGUNTA 2 ( creacion de paquete almacenado "ALMACENAMIENTO")---
CREATE OR REPLACE PACKAGE MANTENIMIENTOS
IS
    FUNCTION SUELDO_MAX RETURN NUMBER;
    FUNCTION SUELDO_MIN RETURN NUMBER;
    FUNCTION SUELDO_TRABAJADOR_GENERO RETURN NUMBER;
    FUNCTION TOTAL_LIBROS RETURN NUMBER;
    FUNCTION COSTOT_AREA_LIBRO RETURN NUMBER;
    PROCEDURE LLAMAR_DATOS;
END;

CREATE OR REPLACE FUNCTION SUELDO_MAX
RETURN NUMBER
IS
   SUELDO_MAX NUMBER;
BEGIN
   SELECT MAX(SUELDO) INTO SUELDO_MAX FROM TRABAJADOR;
   RETURN SUELDO_MAX;
END;

SELECT SUELDO_MAX() FROM dual;
---------------------------------------------------------------------

CREATE OR REPLACE FUNCTION Sueldo_minimo
RETURN NUMBER
IS
   sueldo_min NUMBER;
BEGIN
   SELECT MIN(SUELDO) INTO sueldo_min FROM TRABAJADOR;
   RETURN sueldo_min;
END;

SELECT Sueldo_minimo() FROM dual;

---------------------------------------------------------------------

CREATE OR REPLACE FUNCTION total_sueldos_por_genero
(gen VARCHAR2)
RETURN NUMBER
IS
   t_sueldo NUMBER;
BEGIN
   SELECT SUM(SUELDO) INTO t_sueldo FROM TRABAJADOR WHERE GENERO_TRA = gen;
   RETURN t_sueldo;
END;

SELECT total_sueldos_por_genero('F') FROM dual;
SELECT total_sueldos_por_genero('M') FROM dual;


---------------------------------------------------------------------

CREATE OR REPLACE FUNCTION CostoT_libros
RETURN NUMBER
IS
   costo_total NUMBER;
BEGIN
   SELECT SUM(PRECIOLIB) INTO costo_total FROM LIBRO;
   RETURN costo_total;
END;

SELECT CostoT_libros() FROM dual;

---------------------------------------------------------------------

CREATE OR REPLACE FUNCTION Ctotal_Libro_Area
(area_in VARCHAR2)
RETURN NUMBER
IS
   costo_total NUMBER;
BEGIN
   SELECT SUM(PRECIOLIB) INTO costo_total FROM LIBRO WHERE AREALIB = area_in;
   RETURN costo_total;
END;
SELECT Ctotal_Libro_Area('LPROG') FROM dual;
SELECT Ctotal_Libro_Area('ANALISIS') FROM dual;
SELECT Ctotal_Libro_Area('CAD') FROM dual;
SELECT Ctotal_Libro_Area('ARTE') FROM dual;
SELECT Ctotal_Libro_Area('LIDERAZGO') FROM dual;
SELECT Ctotal_Libro_Area('PROYECTOS') FROM dual;
------------------------------------------------------------------
CREATE OR REPLACE PACKAGE BODY MANTENIMIENTOS
IS 
    FUNCTION SUELDO_MAX RETURN VARCHAR2
    IS 
        SUELDOT NUMBER;
        NOMBRE VARCHAR2(500);
        BEGIN
            SELECT AP_TRA,AM_TRA,NOM_TRA,SUELDO INTO NOMBRE,SUELDOT
            FROM(SELECT AP_TRA,AM_TRA,NOM_TRA,SUELDO FROM TRABAJADOR ORDER BY SUELDO DESC) WHERE ROWNUM<=1;
        NOMBRE:=NOMBRE ||''|| TO_CHAR(SUELDOT);
        RETURN NOMBRE;
        END SUELDO_MAX;
--------------------------------------------------------------------------------------      
    FUNCTION SUELDO_MIN RETURN VARCHAR2
    IS
        SUELDOT NUMBER;
        NOMBRE VARCHAR2(500);
        BEGIN
            SELECT AP_TRA,AM_TRA,NOM_TRA,SUELDO INTO NOMBRE,SUELDOT
            FROM(SELECT AP_TRA,AM_TRA,NOM_TRA,SUELDO FROM TRABAJADOR ORDER BY SUELDO) WHERE ROWNUM<=1;
        NOMBRE:=NOMBRE ||''|| TO_CHAR(SUELDOT);
        RETURN NOMBRE;
        END SUELDO_MIN;
-----------------------------------------------------------------------------------------------   
    FUNCTION SUELDO_TRABAJADOR_GENERO (AREA VARCHAR2) RETURN NUMBER
    IS 
        TOTAL_M INT:=0;
    BEGIN
        SELECT SUM(SUELDO) INTO TOTAL_M FROM TRABAJADOR WHERE SUELDO_T=AREA;
        RETURN TOTAL_M;
    END SUELDO_TRABAJADOR_GENERO;
-------------------------------------------------------------------------------  
    FUNCTION TOTAL_LIBROS RETURN NUMBER
    IS 
        TOTAL NUMBER:=0;
    BEGIN
        SELECT SUM(PRECIOLIB) INTO TOTAL FROM LIBRO;
        RETURN TOTAL;
    END TOTAL_LIBROS;    
-------------------------------------------------------------------------------
    FUNCTION COSTOT_AREA_LIBRO (AREA_LIB VARCHAR2) RETURN NUMBER
    IS
        TOTAL_LIB_AREA INT:=0;
    BEGIN 
        SELECT SUM(PRECIOLIB) INTO TOTAL_LIB_AREA FROM LIBRO WHERE TOTAL_LIBROS=AREA_LIB;
        RETURN TOTAL_LIB_AREA;
    END COSTOT_AREA_LIBRO;
--------------------------------------------------------------------------------   
    PROCEDURE LLAMAR_DATOS
    IS
      BEGIN
          DBMS_OUTPUT.PUT_LINE('======================================');
          DBMS_OUTPUT.PUT_LINE('DETALLES:');
          DBMS_OUTPUT.PUT_LINE('======================================');
          DBMS_OUTPUT.PUT_LINE('SUELDO MAXIMO TRABAJADOR        : ' || SUELDO_MAX);
          DBMS_OUTPUT.PUT_LINE('SUELDO MINIMO TRABAJADOR        : ' || SUELDO_MIN);
          DBMS_OUTPUT.PUT_LINE('TOTAL SUELDO MASCULINO          : ' || SUELDO_TRABAJADOR_GENERO('M'));
          DBMS_OUTPUT.PUT_LINE('TOTAL SUELDO FEMENINO           : ' || SUELDO_TRABAJADOR_GENERO('F'));
          DBMS_OUTPUT.PUT_LINE('TOTALIZACION DE LIBROS          : ' || TOTAL_LIBROS);
          DBMS_OUTPUT.PUT_LINE('TOTAL DE LIBRO LPROG            : ' || COSTO_AREA_LIBRO('LPROG'));
          DBMS_OUTPUT.PUT_LINE('TOTAL DE LIBRO ANALISIS         : ' || COSTO_AREA_LIBRO('ANALISIS'));
          DBMS_OUTPUT.PUT_LINE('TOTAL DE LIBRO CAD              : ' || COSTO_AREA_LIBRO('CAD'));
          DBMS_OUTPUT.PUT_LINE('TOTAL DE LIBRO ARTE             : ' || COSTO_AREA_LIBRO('ARTE'));
          DBMS_OUTPUT.PUT_LINE('TOTAL DE LIBRO LIDERAZGO        : ' || COSTO_AREA_LIBRO('LIDERAZGO'));
          DBMS_OUTPUT.PUT_LINE('TOTAL DE LIBRO PROYECTOS        : ' || COSTO_AREA_LIBRO('PROYECTOS'));
          DBMS_OUTPUT.PUT_LINE('======================================');
          
      END LLAMAR_DATOS;
END MANTENIMIENTOS;
        
        
        
        